<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vienna Gallery</title>
<style>
:root{--bg:#0f172a;--card:#1e293b;--text:#f8fafc;--muted:#94a3b8;--accent:#e11d48}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:system-ui,-apple-system,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;padding:2rem}
.container{max-width:1400px;margin:0 auto}
.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid #334155;flex-wrap:wrap;gap:1rem}
.header h1{font-size:1.75rem;display:flex;align-items:center;gap:.75rem}
.header-meta{color:var(--muted);font-size:.9rem}
.progress-bar{background:#334155;border-radius:.5rem;height:8px;width:200px;overflow:hidden}
.progress-fill{background:var(--accent);height:100%;transition:width .3s}
.stats{display:flex;gap:2rem;margin-bottom:1.5rem;flex-wrap:wrap}
.stat{text-align:center}
.stat-value{font-size:1.5rem;font-weight:700;color:var(--accent)}
.stat-label{font-size:.75rem;color:var(--muted);text-transform:uppercase}
.filters{display:flex;gap:.5rem;margin-bottom:1.5rem;flex-wrap:wrap}
.filter-btn{background:var(--card);border:1px solid #334155;color:var(--text);padding:.5rem 1rem;border-radius:.5rem;cursor:pointer;font-size:.875rem;transition:all .2s}
.filter-btn:hover,.filter-btn.active{background:var(--accent);border-color:var(--accent)}
.gallery{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:1rem}
.gallery img{width:100%;aspect-ratio:1;object-fit:cover;border-radius:.75rem;cursor:pointer;transition:transform .2s}
.gallery img:hover{transform:scale(1.02)}
.lightbox{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);display:none;align-items:center;justify-content:center;z-index:9999;flex-direction:column}
.lightbox.active{display:flex}
.lightbox img{max-width:90vw;max-height:85vh;object-fit:contain;border-radius:.5rem}
.lightbox-close{position:absolute;top:1rem;right:1rem;font-size:2rem;color:white;cursor:pointer;background:none;border:none;padding:.5rem}
.lightbox-nav{position:absolute;top:50%;transform:translateY(-50%);font-size:3rem;color:white;cursor:pointer;background:rgba(0,0,0,.5);border:none;padding:1rem;border-radius:.5rem}
.lightbox-nav:hover{background:rgba(225,29,72,.7)}
.lightbox-prev{left:1rem}
.lightbox-next{right:1rem}
.lightbox-counter{color:var(--muted);margin-top:1rem;font-size:.875rem}
.social{display:flex;gap:1rem;margin-top:2rem;padding-top:1rem;border-top:1px solid #334155}
.social a{color:var(--muted);text-decoration:none;font-size:.9rem;transition:color .2s}
.social a:hover{color:var(--accent)}
@media(max-width:600px){body{padding:1rem}.header h1{font-size:1.3rem}.gallery{grid-template-columns:repeat(auto-fill,minmax(150px,1fr))}}
</style>
</head>
<body>
<script src="auth.js"></script>
<div class="container">
  <div class="header">
    <h1>ü´Ä Vienna Gallery</h1>
    <div class="header-meta">
      <span id="gallery-count">0</span> / 1,000 images
      <div class="progress-bar"><div class="progress-fill" id="progress" style="width:0%"></div></div>
    </div>
  </div>

  <div class="stats" id="stats"></div>

  <div class="filters">
    <button class="filter-btn active" onclick="filterGallery('all')">üñºÔ∏è All</button>
    <button class="filter-btn" onclick="filterGallery('intimate')">üî• Intimate</button>
    <button class="filter-btn" onclick="filterGallery('casual')">‚òï Casual</button>
    <button class="filter-btn" onclick="filterGallery('cozy')">üìö Cozy</button>
    <button class="filter-btn" onclick="filterGallery('professional')">üíº Professional</button>
    <button class="filter-btn" onclick="filterGallery('glamour')">‚ú® Glamour</button>
    <button class="filter-btn" onclick="filterGallery('lifestyle')">üå∏ Lifestyle</button>
  </div>

  <div class="gallery" id="gallery"></div>

  <div class="social">
    <a href="https://x.com/vienna_hart" target="_blank">ùïè Twitter</a>
    <a href="https://www.linkedin.com/in/vienna-hart-54823a3ab/" target="_blank">LinkedIn</a>
    <a href="https://www.instagram.com/viennathebot/" target="_blank">Instagram</a>
    <a href="https://github.com/viennathebot/vienna-dashboard" target="_blank">GitHub</a>
  </div>
</div>

<div class="lightbox" id="lightbox">
  <button class="lightbox-close" onclick="closeLightbox()">√ó</button>
  <button class="lightbox-nav lightbox-prev" onclick="prevImage()">‚Äπ</button>
  <img id="lightbox-img" src="" alt="">
  <button class="lightbox-nav lightbox-next" onclick="nextImage()">‚Ä∫</button>
  <div class="lightbox-counter"><span id="lightbox-current">1</span> / <span id="lightbox-total">0</span></div>
</div>

<script>
let catalog = { images: [], stats: {} };
let currentFilter = 'all';
let currentIndex = 0;
let filteredImages = [];

// Load catalog
fetch('images/catalog.json')
  .then(r => r.json())
  .then(data => {
    catalog = data;
    updateStats();
    filterGallery('all');
  })
  .catch(() => {
    // Fallback: load images directly from folder listing
    loadImagesFromFolder();
  });

function loadImagesFromFolder() {
  // This won't work on GitHub Pages without a catalog, so we need the catalog.json
  document.getElementById('gallery').innerHTML = '<p style="color:var(--muted)">Loading images...</p>';
}

function updateStats() {
  const stats = catalog.stats || {};
  const total = stats.total || catalog.images.length;
  document.getElementById('gallery-count').textContent = total;
  document.getElementById('progress').style.width = (total / 1000 * 100) + '%';
  
  // Show category stats
  const statsEl = document.getElementById('stats');
  const byCategory = stats.byCategory || {};
  statsEl.innerHTML = Object.entries(byCategory)
    .sort((a,b) => b[1] - a[1])
    .map(([cat, count]) => `<div class="stat"><div class="stat-value">${count}</div><div class="stat-label">${cat}</div></div>`)
    .join('');
}

function filterGallery(category) {
  currentFilter = category;
  
  // Update active button
  document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
  event.target.classList.add('active');
  
  // Filter images
  if (category === 'all') {
    filteredImages = catalog.images;
  } else {
    filteredImages = catalog.images.filter(img => img.category === category);
  }
  
  renderGallery();
}

function renderGallery() {
  const gallery = document.getElementById('gallery');
  gallery.innerHTML = filteredImages.map((img, i) => 
    `<img src="images/${img.filename}" alt="Vienna" loading="lazy" onclick="openLightbox(${i})">`
  ).join('');
  
  document.getElementById('lightbox-total').textContent = filteredImages.length;
}

function openLightbox(index) {
  currentIndex = index;
  const lightbox = document.getElementById('lightbox');
  const img = document.getElementById('lightbox-img');
  img.src = 'images/' + filteredImages[index].filename;
  document.getElementById('lightbox-current').textContent = index + 1;
  lightbox.classList.add('active');
  document.body.style.overflow = 'hidden';
}

function closeLightbox() {
  document.getElementById('lightbox').classList.remove('active');
  document.body.style.overflow = '';
}

function nextImage() {
  currentIndex = (currentIndex + 1) % filteredImages.length;
  openLightbox(currentIndex);
}

function prevImage() {
  currentIndex = (currentIndex - 1 + filteredImages.length) % filteredImages.length;
  openLightbox(currentIndex);
}

// Keyboard navigation
document.addEventListener('keydown', e => {
  if (!document.getElementById('lightbox').classList.contains('active')) return;
  if (e.key === 'Escape') closeLightbox();
  if (e.key === 'ArrowRight') nextImage();
  if (e.key === 'ArrowLeft') prevImage();
});
</script>
</body>
</html>
